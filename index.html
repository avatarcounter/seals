<!-- 1. Service worker MUST load before other scripts -->
<script src="coi-serviceworker.js"></script>

<!-- 2. Use the FULL explicit path to the minified library -->
<script src="https://unpkg.com/@ffmpeg/ffmpeg@0.10.1/dist/ffmpeg.min.js"></script>

<script>
    let ffmpegInstance = null;

    async function processVideo() {
        const status = document.getElementById('status');
        const btn = document.getElementById('renderBtn');
        btn.disabled = true;

        try {
            if (!ffmpegInstance) {
                status.innerText = "Loading FFmpeg Engine...";
                
                // 3. Define the instance with an explicit corePath
                // This is required to load the WebAssembly core from the CDN
                ffmpegInstance = FFmpeg.createFFmpeg({ 
                    log: true,
                    corePath: 'https://unpkg.com/@ffmpeg/core@0.10.0/dist/ffmpeg-core.js'
                });
                
                await ffmpegInstance.load();
            }
            
            // ... [Remainder of your processing code]
        } catch (e) {
            status.innerText = "Error: " + e.message;
            console.error(e);
        } finally {
            btn.disabled = false;
        }
    }
</script>
